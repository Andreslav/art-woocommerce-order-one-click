jQuery(function(e){if(typeof awooc_scripts_ajax==="undefined"){console.log("awooc_scripts_ajax not found");return false}if(typeof awooc_scripts_translate==="undefined"){console.log("awooc_scripts_translate not found");return false}if(typeof awooc_scripts_settings==="undefined"){console.log("awooc_scripts_settings not found");return false}if(typeof wpcf7==="undefined"||wpcf7===null){console.log("На странице не существует объекта wpcf7. Что-то не так с темой...");return false}const o=e(".awooc-custom-order-button"),n=e(".awooc-form-custom-order"),d=e(".awooc-form-custom-order-title"),f=e(".awooc-form-custom-order-img"),b=e(".awooc-form-custom-order-price"),a=e(".awooc-form-custom-order-qty"),m=e(".awooc-form-custom-order-sku"),k=e(".awooc-form-custom-order-attr"),j='<div class="awooc-preload-container"><div class="awooc-preload-speeding-wheel"></div></div>';let selectedProduct;e(document).on("hide_variation",function(p){o.addClass("disabled wc-variation-selection-needed")}).on("show_variation",function(q,p){if(false!==p.is_in_stock){o.removeClass("disabled wc-variation-selection-needed")}else{o.addClass("disabled wc-variation-is-unavailable")}if(awooc_scripts_settings.mode==="no_stock_no_price"){if(false===p.is_purchasable||false===p.is_in_stock){o.removeClass("disabled wc-variation-selection-needed");e("body.woocommerce").find(".single_variation").hide();e("body.woocommerce").find(".quantity").hide();e("body.woocommerce").find(".woocommerce-variation-add-to-cart .single_add_to_cart_button").hide()}}}).on("click",".awooc-custom-order-button",function(p){if(e(this).is(".disabled")){p.preventDefault();if(e(this).is(".wc-variation-is-unavailable")){window.alert(wc_add_to_cart_variation_params.i18n_unavailable_text)}else{if(e(this).is(".wc-variation-selection-needed")){window.alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text)}}return false}let prodictSelectedId,productVariantId=e(".variations_form").find('input[name="variation_id"]').val(),productId=e(this).attr("data-value-product-id"),productQty=e(".quantity").find('input[name="quantity"]').val(),dataOut={};if(0!==productVariantId&&typeof productVariantId!=="undefined"){prodictSelectedId=productVariantId}else{prodictSelectedId=productId}let data={id:prodictSelectedId,action:"awooc_ajax_product_form",nonce:awooc_scripts_ajax.nonce};e.ajax({url:awooc_scripts_ajax.url,data:data,type:"POST",dataType:"json",beforeSend:function(r,q){e(p.currentTarget).fadeIn(200).prepend(j)},success:function(q){e(p.currentTarget).find(".awooc-preload-container").remove();e(".awooc-close").attr("title",awooc_scripts_translate.title_close);dataOut={outID:"ID: "+prodictSelectedId,outTitle:q.title===false?"":"\n"+awooc_scripts_translate.product_title+q.title,outAttr:q.attr===false?"":"\n"+q.attr,outPrice:q.price===false?"":"\n"+awooc_scripts_translate.product_price+q.pricenumber,outSku:q.sku===false?"":"\n"+q.sku,outCat:q.cat===false?"":"\n"+q.cat,outLink:q.link===false?"":"\n"+q.link,outQty:q.qty===false?"":"\n"+awooc_scripts_translate.product_qty+productQty};d.text(q.title);f.html(q.image);b.html(q.price);b.after(q.qty);a.text(awooc_scripts_translate.product_qty+productQty);m.html(q.sku);k.html(q.attr);e(".awooc-col.columns-right").html(q.form);l();let hiddenData=h(dataOut);e(".awooc-hidden-data").val(hiddenData);e(".awooc-hidden-product-id").val(prodictSelectedId);e(".awooc-hidden-product-qty").val(productQty);c();g(n);selectedProduct={productId:prodictSelectedId,productName:q.title,productSku:q.productSku,productQty:productQty,productPrice:q.pricenumber,productCat:q.productCat,productAttr:q.productAttr?q.productAttr.replace(/<\/?[^>]+>/g,""):""};e(document.body).trigger("awooc_popup_open_trigger",[q]);return q}});return false}).on("click",".awooc-close",function(){e.unblockUI();n.hide()}).on("wpcf7mailsent",function(p){e(document.body).trigger("awooc_mail_sent_trigger",{selectedProduct:selectedProduct,mailDetail:p});setTimeout(e.unblockUI,3000);setTimeout(function(){e(".awooc-form-custom-order .wpcf7-form")[0].reset();e(".awooc-form-custom-order .wpcf7-response-output").remove()},3000)}).on("wpcf7invalid",function(q,p){e(document.body).trigger("awooc_mail_invalid_trigger",[q,p]);setTimeout(function(){e(".awooc-form-custom-order .wpcf7-response-output").remove();e(".awooc-form-custom-order .wpcf7-not-valid-tip").remove()},5000)});function l(){e(".awooc-form-custom-order div.wpcf7 > form").each(function(){let $form=e(this);wpcf7.initForm($form);if(wpcf7.cached){wpcf7.refill($form)}})}function h(p){return"\n"+awooc_scripts_translate.product_data_title+"\n ———"+p.outTitle+"\n"+p.outID+p.outCat.replace(/(<([^>]+)>)/ig,"")+p.outPrice+p.outAttr.replace(/(<([^>]+)>)/ig,"")+p.outSku.replace(/(<([^>]+)>)/ig,"")+p.outQty+p.outLink}function g(p){e.blockUI({message:p,css:awooc_scripts_settings.popup.css,overlayCSS:awooc_scripts_settings.popup.overlay,fadeIn:awooc_scripts_settings.popup.fadeIn,fadeOut:awooc_scripts_settings.popup.fadeOut,focusInput:awooc_scripts_settings.popup.focusInput,bindEvents:true,timeout:0,allowBodyStretch:true,centerX:true,centerY:true,onBlock:function(){p.show()},onUnblock:function(){p.hide();i();e(document.body).trigger("awooc_popup_close_trigger")},onOverlayClick:function(){p.hide();e("html").css({overflow:"initial"});e.unblockUI();i()}})}function i(){d.empty();f.empty();b.empty();a.empty();m.empty();k.empty()}function c(){let mask_fields=e(".awooc-form-custom-order .wpcf7-mask");if(mask_fields.length>0){mask_fields.each(function(){let $this=e(this),data_mask=$this.data("mask");try{$this.mask(data_mask);if(data_mask.indexOf("*")===-1&&data_mask.indexOf("a")===-1){$this.attr({inputmode:"numeric"})}}catch(p){console.log("Error "+p.name+":"+p.message+"\n"+p.stack)}})}}});