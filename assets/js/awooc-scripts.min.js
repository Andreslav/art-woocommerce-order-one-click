/*! For license information please see awooc-scripts.min.js.LICENSE.txt */
jQuery((function(o){"use strict";if("undefined"==typeof awooc_scripts_ajax)return console.warn("awooc_scripts_ajax not found"),!1;if("undefined"==typeof awooc_scripts_translate)return console.warn("awooc_scripts_translate not found"),!1;if("undefined"==typeof awooc_scripts_settings)return console.warn("awooc_scripts_settings not found"),!1;if("undefined"==typeof wpcf7||null===wpcf7)return console.warn("На странице не существует объекта wpcf7. Что-то не так с темой..."),!1;var t={xhr:!1,$button:o(".awooc-button-js"),analyticData:{},init:function(){o(document.body).on("click",".awooc-button-js",this.popup).on("awooc_popup_ajax_trigger",this.removeSkeleton).on("click",".awooc-close, .blockOverlay",this.unBlock).on("hide_variation",this.disableButton).on("show_variation",this.enableButton).on("wpcf7mailsent",this.sendSuccess).on("wpcf7invalid",this.sendInvalid)},disableButton:function(){t.$button.addClass("disabled wc-variation-selection-needed")},enableButton:function(a,n){n.is_in_stock?t.$button.removeClass("disabled wc-variation-selection-needed"):t.$button.addClass("disabled wc-variation-is-unavailable"),"dont_show_add_to_card"===awooc_scripts_settings.mode&&t.$button.removeClass("disabled wc-variation-selection-needed"),"no_stock_no_price"===awooc_scripts_settings.mode&&(!1===n.is_purchasable||!1===n.is_in_stock?(t.$button.removeClass("disabled wc-variation-selection-needed"),o("body.woocommerce").find(".single_variation").hide(),o("body.woocommerce").find(".quantity").hide(),o("body.woocommerce").find(".woocommerce-variation-add-to-cart .single_add_to_cart_button").hide()):(o("body.woocommerce").find(".single_variation").show(),o("body.woocommerce").find(".quantity").show(),o("body.woocommerce").find(".woocommerce-variation-add-to-cart .single_add_to_cart_button").show()))},getProductID:function(t){var a=o(".variations_form").find('input[name="variation_id"]').val(),n=o(t.target).attr("data-value-product-id");return 0!==a&&void 0!==a&&(n=a),n},getQty:function(){return o(".quantity").find('input[name="quantity"]').val()||1},unBlock:function(){o.unblockUI()},removeSkeleton:function(){o(".awooc-popup-inner").find(".awooc-popup-item").each((function(t,a){o(a).removeClass("skeleton-loader")}))},addedToMailData:function(o){var t=o.data.toMail,a=Object.keys(t),n="\n"+awooc_scripts_translate.product_data_title+"\n———\n";return a.forEach((function(o){n+=t[o]+"\n"})),n},addedToPopupData:function(t){var a=t.data.toPopup;Object.keys(a).forEach((function(t){o(".awooc-popup-"+t).html(a[t])}))},sendSuccess:function(a){setTimeout(t.unBlock,awooc_scripts_settings.popup.mailsent_timeout),o(document.body).trigger("awooc_mail_sent_trigger",{selectedProduct:t.analyticData,mailDetail:a})},sendInvalid:function(t,a){o(document.body).trigger("awooc_mail_invalid_trigger",[t,a]),setTimeout((function(){o(".awooc-form-custom-order .wpcf7-response-output").empty(),o(".awooc-form-custom-order .wpcf7-not-valid-tip").remove()}),awooc_scripts_settings.popup.invalid_timeout)},initMask:function(){var t=o(".awooc-form-custom-order .wpcf7-mask");t.length>0&&t.each((function(){var t=o(this),a=t.data("mask");try{t.mask(a),-1===a.indexOf("*")&&-1===a.indexOf("a")&&t.attr({inputmode:"numeric"})}catch(o){console.error("Error "+o.name+":"+o.message+"\n"+o.stack)}}))},request:function(a){var n={id:t.getProductID(a),qty:t.getQty(a),action:"awooc_ajax_product_form",nonce:awooc_scripts_ajax.nonce};t.xhr=o.ajax({url:awooc_scripts_ajax.url,data:n,type:"POST",dataType:"json",success:function(n){t.addedToPopupData(n),t.analyticData=n.data.toAnalytics,t.initContactForm(),t.initMask(),o("textarea.awooc-hidden-data").val(t.addedToMailData(n)),o(".awooc-hidden-product-id").val(t.getProductID(a)),o(".awooc-hidden-product-qty").val(t.getQty(a)),o(document.body).trigger("awooc_popup_ajax_trigger",n)},error:function(o){o.responseJSON&&console.error(o.responseJSON.data)}})},initContactForm:function(){o(".awooc-form-custom-order div.wpcf7 > form").each((function(){var t=o(this).find('input[name="_wpcf7_version"]').val();if(null!=t&&t<="5.4"){var a=o(this);wpcf7.initForm(a),wpcf7.cached&&wpcf7.refill(a)}else wpcf7.init(this)}))},popup:function(a){if(o(this).is(".disabled"))return a.preventDefault(),o(this).is(".wc-variation-is-unavailable")?window.alert(wc_add_to_cart_variation_params.i18n_unavailable_text):o(this).is(".wc-variation-selection-needed")&&window.alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text),!1;o.blockUI({message:awooc_scripts_settings.template,css:awooc_scripts_settings.popup.css,overlayCSS:awooc_scripts_settings.popup.overlay,fadeIn:awooc_scripts_settings.popup.fadeIn,fadeOut:awooc_scripts_settings.popup.fadeOut,focusInput:awooc_scripts_settings.popup.focusInput,bindEvents:!1,timeout:0,allowBodyStretch:!0,centerX:!0,centerY:!0,blockMsgClass:"blockMsg blockMsgAwooc",onBlock:function(){o(document.body).trigger("awooc_popup_open_trigger"),t.request(a)},onUnblock:function(){o(document.body).trigger("awooc_popup_close_trigger")},onOverlayClick:function(){o("html").css({overflow:"initial"})}})}};t.init()}));