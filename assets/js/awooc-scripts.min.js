jQuery(function(e){if(typeof wc_add_to_cart_params==="undefined"){return false}if(typeof awooc_scripts==="undefined"){return false}const n=e(".awooc-custom-order.button"),d=e(".awooc-form-custom-order-title"),f=e(".awooc-form-custom-order-img"),b=e(".awooc-form-custom-order-price"),a=e(".awooc-form-custom-order-qty"),m=e(".awooc-form-custom-order-sku"),k=e(".awooc-form-custom-order-attr"),j='<div class="cssload-container"><div class="cssload-speeding-wheel"></div></div>';let selectedProduct;e(document).on("hide_variation",function(o){n.addClass("disabled wc-variation-selection-needed")}).on("show_variation",function(p,o){if(false!==o.is_in_stock){n.removeClass("disabled wc-variation-selection-needed")}else{n.addClass("disabled wc-variation-is-unavailable")}if(awooc_scripts.mode==="no_stock_no_price"){if(false===o.is_purchasable||false===o.is_in_stock){n.removeClass("disabled wc-variation-selection-needed");e("body.woocommerce").find(".single_variation").hide();e("body.woocommerce").find(".quantity").hide();e("body.woocommerce").find(".woocommerce-variation-add-to-cart .single_add_to_cart_button").hide()}}}).on("click",".awooc-custom-order.button",function(o){if(e(this).is(".disabled")){o.preventDefault();if(e(this).is(".wc-variation-is-unavailable")){window.alert(wc_add_to_cart_variation_params.i18n_unavailable_text)}else{if(e(this).is(".wc-variation-selection-needed")){window.alert(wc_add_to_cart_variation_params.i18n_make_a_selection_text)}}return false}let prodictSelectedId,productVariantId=e(".variations_form").find('input[name="variation_id"]').val(),productId=e(this).attr("data-value-product-id"),productQty=e(".quantity").find('input[name="quantity"]').val(),dataOut={};if(0!==productVariantId&&typeof productVariantId!=="undefined"){prodictSelectedId=productVariantId}else{prodictSelectedId=productId}let data={id:prodictSelectedId,action:"awooc_ajax_product_form",nonce:awooc_scripts.nonce};let request=e.ajax({url:awooc_scripts.url,data:data,type:"POST",dataType:"json",beforeSend:function(q,p){e(o.currentTarget).block({message:null,overlayCSS:{opacity:0.6}});e(o.currentTarget).fadeIn(200).prepend(j)},success:function(p){e(o.currentTarget).unblock();e(o.currentTarget).find(".cssload-container").remove();e(".awooc-close").attr("title",awooc_scripts.title_close);dataOut={outID:"ID: "+prodictSelectedId,outTitle:p.title===false?"":"\n"+awooc_scripts.product_title+p.title,outAttr:p.attr===false?"":"\n"+p.attr,outPrice:p.price===false?"":"\n"+awooc_scripts.product_price+p.pricenumber,outSku:p.sku===false?"":"\n"+p.sku,outCat:p.cat===false?"":"\n"+p.cat,outLink:p.link===false?"":"\n"+p.link,outQty:p.qty===false?"":"\n"+awooc_scripts.product_qty+productQty};d.text(p.title);f.html(p.image);b.html(p.price);b.after(p.qty);a.text(awooc_scripts.product_qty+productQty);m.html(p.sku);k.html(p.attr);e(".awooc-col.columns-right").html(p.form);l();let hiddenData=h(dataOut);e(".awooc-hidden-data").val(hiddenData);e(".awooc-hidden-product-id").val(prodictSelectedId);e(".awooc-hidden-product-qty").val(productQty);c();g();selectedProduct={productId:prodictSelectedId,productName:p.title,productSku:p.productSku,productQty:productQty,productPrice:p.pricenumber,productCat:p.productCat,productAttr:p.productAttr};e(document.body).trigger("awooc_popup_open_trigger",[p]);return p}});return false}).on("click",".awooc-close",function(){e.unblockUI();e("#awooc-form-custom-order").addClass("awooc-hide")}).on("wpcf7mailsent",function(o){e(document.body).trigger("awooc_mail_sent_trigger",{selectedProduct:selectedProduct,mailDetail:o});setTimeout(e.unblockUI,3000);setTimeout(function(){e(".awooc-form-custom-order .wpcf7-form")[0].reset();e(".awooc-form-custom-order .wpcf7-response-output").remove()},3000)}).on("wpcf7invalid",function(p,o){e(document.body).trigger("awooc_mail_invalid_trigger",[p,o]);setTimeout(function(){e(".awooc-form-custom-order .wpcf7-response-output").remove();e(".awooc-form-custom-order .wpcf7-not-valid-tip").remove()},5000)});function l(){e(".awooc-form-custom-order div.wpcf7 > form").each(function(){let $form=e(this);wpcf7.initForm($form);if(wpcf7.cached){wpcf7.refill($form)}})}function h(o){return"\n"+awooc_scripts.product_data_title+"\n &mdash;&mdash;&mdash;"+o.outTitle+"\n"+o.outID+o.outCat.replace(/(<([^>]+)>)/ig,"")+o.outPrice+o.outAttr.replace(/(<([^>]+)>)/ig,"")+o.outSku.replace(/(<([^>]+)>)/ig,"")+o.outQty+o.outLink}function g(){e.blockUI({message:e("#awooc-form-custom-order"),css:{width:"100%",maxWidth:"600px",maxHeight:"600px",top:"50%",left:"50%",border:"4px",borderRadius:"4px",cursor:"default",overflowY:"auto",boxShadow:"0px 0px 3px 0px rgba(0, 0, 0, 0.2)",zIndex:"1000000",transform:"translate(-50%, -50%)"},overlayCSS:{zIndex:"1000000",backgroundColor:"#000",opacity:0.6,cursor:"wait"},bindEvents:true,timeout:0,fadeIn:awooc_scripts.fadeIn,fadeOut:awooc_scripts.fadeOut,allowBodyStretch:true,centerX:true,centerY:true,onBlock:function(){e("#awooc-form-custom-order").removeClass("awooc-hide")},onUnblock:function(){e("#awooc-form-custom-order").addClass("awooc-hide");i();e(document.body).trigger("awooc_popup_close_trigger")},onOverlayClick:function(){e("#awooc-form-custom-order").addClass("awooc-hide");e("html").css({overflow:"initial"});e.unblockUI();i()}})}function i(){d.empty();f.empty();b.empty();a.empty();m.empty();k.empty()}function c(){let mask_fields=e(".awooc-form-custom-order .wpcf7-mask");if(mask_fields.length>0){mask_fields.each(function(){let $this=e(this),data_mask=$this.data("mask");try{$this.mask(data_mask);if(data_mask.indexOf("*")===-1&&data_mask.indexOf("a")===-1){$this.attr({inputmode:"numeric"})}}catch(o){console.log("Ошибка "+o.name+":"+o.message+"\n"+o.stack)}})}}});